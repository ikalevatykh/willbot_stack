<?xml version="1.0"?>
<!--
  Arm + gripper launch.  Loads willbot description. 
  Connects to arm and gripper. Starts moveit interface.

  Usage:
    willbot_real.launch
      setup:=<paris|grenoble>
      robot_ip:=<value> gripper_ip:=<value> 
      camera:=<kinect|kinect2|realsense|none>
-->
<launch>

  <arg name="setup" default="paris"/>

  <group if="$(eval arg('setup') == 'paris')">
    <arg name="robot_ip" default="192.168.1.20"/>
    <arg name="gripper_ip" default="192.168.1.11"/>
  </group>

  <group if="$(eval arg('setup') == 'grenoble')">
    <arg name="robot_ip" default="192.168.1.1"/>
    <arg name="gripper_ip" default="192.168.1.11"/>
  </group>  

  <arg name="gripper_name" default="gripper" />
  <arg name="arm_name" default="arm" />

  <arg name="ur_limited" default="false"/>
  <arg name="init_gripper" default="true" />

  <arg name="camera" default="none">

  <!-- customize logging settings -->
  <include file="$(find willbot_bringup)/launch/customize_log.launch" />

  <!-- upload robot model -->
  <include file="$(find willbot_description)/launch/willbot_upload.launch">
    <arg name="setup" value="$(arg setup)"/>
  </include>

  <!-- bringup arm -->
  <include file="$(find willbot_bringup)/launch/ur_ros_control.launch">
    <arg name="robot_ip" value="$(arg robot_ip)"/>
    <arg name="arm_name" value="$(arg arm_name)" />
  </include>

  <!-- bringup gripper -->
  <include file="$(find willbot_bringup)/launch/gripper_ros_control.launch">
    <arg name="gripper_ip" value="$(arg gripper_ip)"/>
    <arg name="gripper_name" value="$(arg gripper_name)" />
    <arg name="init_gripper" value="$(arg init_gripper)" />
  </include>

  <!-- combine joint states from arm and hand -->
  <node name="joint_state_publisher" pkg="joint_state_publisher" type="joint_state_publisher">
    <param name="rate" value="50"/>
    <rosparam param="source_list">[/arm/joint_states, /gripper/joint_states]</rosparam>
  </node>

  <!-- convert joint states to /tf tranforms -->
  <node name="robot_state_publisher" pkg="robot_state_publisher" type="robot_state_publisher"/>

  <!-- moveit -->
  <include file="$(find willbot_moveit_config)/launch/willbot_moveit_planning_execution.launch" />

  <!-- camera -->
  <include file="$(find willbot_bringup)/launch/camera_bringup.launch">
    <arg name="camera" value="$(arg camera)" />
  </include>

</launch>